version: 1
applications:
  - appRoot: apps/docs
    frontend:
      phases:
        preBuild:
          commands:
            - echo  --------------------- > package DOCS PREBUILD
            - npm install -g pnpm
            - pnpm install
            - cd ../../
        build:
          commands:
            - echo --------------------- >  DOCS BUILD
            - pnpm run build
            - cd apps/docs
            - ls -la
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - node_modules
          - apps/app/node_modules
          - packages/*/node_modules
  - appRoot: apps/main
    frontend:
      phases:
        preBuild:
          commands:
            - echo FRONTEND MAIN PREBUILD HOLA MUNDO
            - cd ../../
            - npm install -g pnpm
            - pnpm install
        build:
          commands:
            - cd apps/main
            - echo "NEXT_PUBLIC_DOCS_URL=$NEXT_PUBLIC_DOCS_URL" >> .env
            - echo $NEXT_PUBLIC_DOCS_URL
            - cat .env
            - cd ../../
            - pnpm run build
            - cd apps/main
            - ls -la
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - node_modules
